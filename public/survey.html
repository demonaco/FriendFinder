<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <title>Friend Finder</title>
</head>

<body>
    <h2>Survey Questions</h2>
    <br>
    <div>
        <input class="form-control form-control-lg" id="nameField" type="text" placeholder="Name">
    </div>
    <br>
    <br>
    <div id="container">
        <input class="form-control form-control-lg" id="photoField" type="text" placeholder="Photo (URL required)">
        <br>
        <p>Below are 10 questions. You will pick a value answer from 1 (not likely) to 5 (very likely) for each of them.
            Once you have completed the 10 questions, click the submit button and we'll find you your new BFF! </p>
        <h3>Question #1</h3>
        <p>Rank your answer to the following: "I love to travel, and exploring new locations/places is something I
            value".</p>
        <select class="form-control form-control-sm" id="Q1">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #2</h3>
        <p>Rank your answer to the following: "I prefer to have my daily set routine than have a day that is more
            spontaneous or unknown".</p>
        <select class="form-control form-control-sm" id="Q2">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #3</h3>
        <p>Rank your answer to the following: "I love to eat new things and will try pretty much anything a first time."
        </p>
        <select class="form-control form-control-sm" id="Q3">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #4</h3>
        <p>Rank your answer to the following: "The amount a person does or doesn't tip says a lot about their
            character".</p>
        <select class="form-control form-control-sm" id="Q4">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #5</h3>
        <p>Rank your answer to the following: "Education is important to me. I think a person's educational level says a
            lot about them."</p>
        <select class="form-control form-control-sm" id="Q5">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #6</h3>
        <p>Rank your answer to the following: "The number one way I try to live my life is by following the "Golden
            Rule".</p>
        <select class="form-control form-control-sm" id="Q6">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #7</h3>
        <p>Rank your answer to the following: "It's important to me that my friends share the same beliefs and values as
            I do."</p>
        <select class="form-control form-control-sm" id="Q7">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #8</h3>
        <p>Rank your answer to the following: "Reading books is important to me and I try to read books as often as
            possible."</p>
        <select class="form-control form-control-sm" id="Q8">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #9</h3>
        <p>Rank your answer to the following: "I prefer to be alone more times than not."</p>
        <select class="form-control form-control-sm" id="Q9">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
        <br>
        <h3>Question #10</h3>
        <p>Rank your answer to the following: "Change scares me."</p>
        <select class="form-control form-control-sm" id="Q10">
            <option>
                <li>1</li>
            </option>
            <option>
                <li>2</li>
            </option>
            <option>
                <li>3</li>
            </option>
            <option>
                <li>4</li>
            </option>
            <option>
                <li>5</li>
            </option>
        </select>
    </div>
    <br>
    <br>

    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary btn-lg btn-block" data-toggle="modal" data-target="#myModal"
        id="submitButton">
        Submit Answers
    </button>


    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <!--content for modal-->
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalCenterTitle">Meet your new friend!</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <br>
    <br>
    <footer>
        <a href="/api/friends">API Friends List</a>
        |
        <a href="https://github.com/demonaco/FriendFinder">GitHub Repo</a>
    </footer>
    <br>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>


</body>

</html>

<script type="text/javascript">

    //capturing event click listener and assigning key/values for our newFriend object variable
    $("#submitButton").on("click", function (event) {
        event.preventDefault();

        var newFriend = {
            "name": $("#nameField").val().trim(),
            "photo": $("#photoField").val().trim(),
            "scores": [$("#Q1").val(),
            $("#Q2").val(),
            $("#Q3").val(),
            $("#Q4").val(),
            $("#Q5").val(),
            $("#Q6").val(),
            $("#Q7").val(),
            $("#Q8").val(),
            $("#Q9").val(),
            $("#Q10").val()
            ]

        }

        console.log(newFriend);

        // Taking user input and sending it to our API Friends list as an object
        $.ajax({
            type: 'POST',
            url: '/api/friends',
            data: newFriend,
            success: function (data) {
                if (data) {
                    console.log(data)
                } else {
                    alert("Sorry, there was an error with your submission, please try again..")
                }
            }


        })


        //once info is submitted to API, do comparison

        //clear our answer fields
        $("#nameField").val("");
        $("#photoField").val("");
        $("#Q1").val("");
        $("#Q2").val("");
        $("#Q3").val("");
        $("#Q4").val("");
        $("#Q5").val("");
        $("#Q6").val("");
        $("#Q7").val("");
        $("#Q8").val("");
        $("#Q9").val("");
        $("#Q10").val("");

        $.ajax({ url: '/api/friends', method: "GET" }).then(function (friends) {

            for (var i = 0; i < friends[i].scores.length; i++) {
                
                for (var j = 0; j < newFriend.scores.length; j++) {
                    // console.log(Math.abs(newFriend.scores[j]) - Math.abs(friends[i].scores[i]))
                    var userScoreArr = [];
                    userScoreArr.push(newFriend.scores);
                    
                    var dataFriendOne = [];
                    dataFriendOne.push(friends[0].scores)
                    
                    var dataFriendTwo = [];
                    dataFriendTwo.push(friends[1].scores)
                   
                    var dataFriendThree = [];
                    dataFriendThree.push(friends[2].scores)
                    
                    var dataFriendFour = [];
                    dataFriendFour.push(friends[3].scores)
                   
                    var dataFriendFive = [];
                    dataFriendFive.push(friends[4].scores)
                   

                    var resultOne = (eval(userScoreArr.join('+')) - eval(dataFriendOne.join('+')))
                    
                    var absOne = (Math.abs(resultOne))
                    

                    var resultTwo = (eval(userScoreArr.join('+')) - eval(dataFriendTwo.join('+')))
                    
                    var absTwo = (Math.abs(resultTwo))

                    var resultThree = (eval(userScoreArr.join('+')) - eval(dataFriendThree.join('+')))
                  
                    var absThree = (Math.abs(resultThree))

                    var resultFour = (eval(userScoreArr.join('+')) - eval(dataFriendFour.join('+')))
                    
                    var absFour = (Math.abs(resultFour))


                    var resultFive = (eval(userScoreArr.join('+')) - eval(dataFriendFive.join('+')))
                    
                    var absFive = (Math.abs(resultFive))

                    //comparing absolute values to find closest match
                    if (absOne = 0 || absOne <= 1) {
                      
                        var img1 = $("<img>")
                        $(".modal-body").text(friends[0].name)
                        $(".modal-body").append(img1.attr('src', friends[0].photo))
                    } else if (absTwo = 0 || absTwo <= 1) {
                        
                        var img2 = $("<img>")
                        $(".modal-body").text(friends[1].name)
                        $(".modal-body").append(img2.attr('src', friends[1].photo))
                    } else if (absThree = 0 || absThree <= 1) {
                        var img3 = $("<img>")
                        
                        $(".modal-body").text(friends[2].name)
                        $(".modal-body").append(img3.attr('src', friends[2].photo))
                    } else if (absFour = 0 || absFour <= 1) {
                        var img4 = $("<img>")
                        
                        $(".modal-body").text(friends[3].name)
                        $(".modal-body").append(img4.attr('src', friends[3].photo))
                    } else if (absFive = 0 || absFive <= 1) {
                        var img5 = $("<img>")
                        
                        $(".modal-body").text(friends[4].name)
                        $(".modal-body").append(img5.attr('src', friends[4].photo))
                    } else if (absOne = 2)
                    {
                   
                        var img1 = $("<img>")
                        $(".modal-body").text(friends[0].name)
                        $(".modal-body").append(img1.attr('src', friends[0].photo))
                    } else if (absTwo = 2 ) {
                        
                        var img2 = $("<img>")
                        $(".modal-body").text(friends[1].name)
                        $(".modal-body").append(img2.attr('src', friends[1].photo))

                    } else if (absThree = 2) {
                        var img3 = $("<img>")
                        console.log("it is")
                        $(".modal-body").text(friends[2].name)
                        $(".modal-body").append(img3.attr('src', friends[2].photo))

                    } else if (absFour = 2) {
                        var img4 = $("<img>")
                       
                        $(".modal-body").text(friends[3].name)
                        $(".modal-body").append(img4.attr('src', friends[3].photo))

                    } else if (absFive = 2) {
                        var img5 = $("<img>")
                        
                        $(".modal-body").text(friends[4].name)
                        $(".modal-body").append(img5.attr('src', friends[4].photo))
                    }
                     else if (absOne = 3)
                    {
                        
                        var img1 = $("<img>")
                        $(".modal-body").text(friends[0].name)
                        $(".modal-body").append(img1.attr('src', friends[0].photo))
                    } else if (absTwo = 3) {
                        
                        var img2 = $("<img>")
                        $(".modal-body").text(friends[1].name)
                        $(".modal-body").append(img2.attr('src', friends[1].photo))

                    } else if (absThree = 3) {
                        
                        $(".modal-body").text(friends[2].name)
                        $(".modal-body").append(img3.attr('src', friends[2].photo))

                    } else if (absFour = 3) {
                        var img4 = $("<img>")
                       
                        $(".modal-body").text(friends[3].name)
                        $(".modal-body").append(img4.attr('src', friends[3].photo))

                    } else if (absFive = 3) {
                        var img5 = $("<img>")
                        
                        $(".modal-body").text(friends[4].name)
                        $(".modal-body").append(img5.attr('src', friends[4].photo))
                    } else if (absOne = 4)
                    {
                      
                        var img1 = $("<img>")
                        $(".modal-body").text(friends[0].name)
                        $(".modal-body").append(img1.attr('src', friends[0].photo))
                    } else if (absTwo = 4) {
                        
                        var img2 = $("<img>")
                        $(".modal-body").text(friends[1].name)
                        $(".modal-body").append(img2.attr('src', friends[1].photo))

                    } else if (absThree = 4) {
                        var img3 = $("<img>")
                       
                        $(".modal-body").text(friends[2].name)
                        $(".modal-body").append(img3.attr('src', friends[2].photo))

                    } else if (absFour = 4) {
                        var img4 = $("<img>")
                      
                        $(".modal-body").text(friends[3].name)
                        $(".modal-body").append(img4.attr('src', friends[3].photo))

                    } else if (absFive = 4) {
                        var img5 = $("<img>")
                      
                        $(".modal-body").text(friends[4].name)
                        $(".modal-body").append(img5.attr('src', friends[4].photo))
                    

                }

            }

            $('#myModal').on('shown.bs.modal', function () {
                $('#myInput').trigger('focus')
            })
        }

        })

    })

</script>